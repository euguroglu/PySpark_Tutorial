{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068041250_-772922344","id":"20210410-152041_2019736162","dateCreated":"2021-04-10T15:20:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:225","text":"%md\n### Let's make sure Spark is working first\nLet's see what version we're working with.","dateUpdated":"2021-04-10T15:22:24+0000","dateFinished":"2021-04-10T15:22:34+0000","dateStarted":"2021-04-10T15:22:24+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Let's make sure Spark is working first</h3>\n<p>Let's see what version we're working with.</p>\n"}]}},{"text":"sc.version\n","user":"anonymous","dateUpdated":"2021-04-10T15:23:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068144484_-421337947","id":"20210410-152224_1737372917","dateCreated":"2021-04-10T15:22:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:687","dateFinished":"2021-04-10T15:24:32+0000","dateStarted":"2021-04-10T15:23:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: String = 2.3.0.2.6.5.0-292\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068211073_-1282882679","id":"20210410-152331_1671325779","dateCreated":"2021-04-10T15:23:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:788","text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\necho \"Downladed\"","dateUpdated":"2021-04-10T15:27:26+0000","dateFinished":"2021-04-10T15:27:29+0000","dateStarted":"2021-04-10T15:27:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2021-04-10 15:27:26--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.77.92\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.77.92|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  178K 11s\n    50K .......... .......... .......... .......... ..........  4%  325K 8s\n   100K .......... .......... .......... .......... ..........  7%  205M 5s\n   150K .......... .......... .......... .......... ..........  9% 1.53M 4s\n   200K .......... .......... .......... .......... .......... 12%  491K 4s\n   250K .......... .......... .......... .......... .......... 14% 4.35M 3s\n   300K .......... .......... .......... .......... .......... 17%  394K 3s\n   350K .......... .......... .......... .......... .......... 19% 8.92M 3s\n   400K .......... .......... .......... .......... .......... 22% 5.16M 3s\n   450K .......... .......... .......... .......... .......... 24% 2.95M 2s\n   500K .......... .......... .......... .......... .......... 27%  579M 2s\n   550K .......... .......... .......... .......... .......... 29%  510K 2s\n   600K .......... .......... .......... .......... .......... 32% 2.60M 2s\n   650K .......... .......... .......... .......... .......... 34% 9.12M 2s\n   700K .......... .......... .......... .......... .......... 36% 6.75M 1s\n   750K .......... .......... .......... .......... .......... 39% 6.70M 1s\n   800K .......... .......... .......... .......... .......... 41% 7.57M 1s\n   850K .......... .......... .......... .......... .......... 44% 4.37M 1s\n   900K .......... .......... .......... .......... .......... 46% 8.61M 1s\n   950K .......... .......... .......... .......... .......... 49% 3.88M 1s\n  1000K .......... .......... .......... .......... .......... 51% 9.82M 1s\n  1050K .......... .......... .......... .......... .......... 54% 5.11M 1s\n  1100K .......... .......... .......... .......... .......... 56% 9.19M 1s\n  1150K .......... .......... .......... .......... .......... 59%  799K 1s\n  1200K .......... .......... .......... .......... .......... 61% 4.93M 1s\n  1250K .......... .......... .......... .......... .......... 64% 6.33M 1s\n  1300K .......... .......... .......... .......... .......... 66% 8.65M 1s\n  1350K .......... .......... .......... .......... .......... 68% 12.0M 0s\n  1400K .......... .......... .......... .......... .......... 71% 3.48M 0s\n  1450K .......... .......... .......... .......... .......... 73%  602M 0s\n  1500K .......... .......... .......... .......... .......... 76% 2.53M 0s\n  1550K .......... .......... .......... .......... .......... 78% 41.2M 0s\n  1600K .......... .......... .......... .......... .......... 81% 11.8M 0s\n  1650K .......... .......... .......... .......... .......... 83% 1.67M 0s\n  1700K .......... .......... .......... .......... .......... 86% 8.20M 0s\n  1750K .......... .......... .......... .......... .......... 88% 76.7M 0s\n  1800K .......... .......... .......... .......... .......... 91% 4.59M 0s\n  1850K .......... .......... .......... .......... .......... 93% 5.94M 0s\n  1900K .......... .......... .......... .......... .......... 96% 8.73M 0s\n  1950K .......... .......... .......... .......... .......... 98%  195M 0s\n  2000K .......... .......... ..........                      100% 37.9M=1.1s\n\n2021-04-10 15:27:27 (1.77 MB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2021-04-10 15:27:27--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.104.91\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.104.91|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  178K 1s\n    50K .......... .......... .......... .......... .......... 43%  368K 1s\n   100K .......... .......... .......... .......... .......... 64% 1.12M 0s\n   150K .......... .......... .......... .......... .......... 86% 8.77M 0s\n   200K .......... .......... ..........                      100%  311K=0.6s\n\n2021-04-10 15:27:29 (408 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\nDownladed\n"}]}},{"text":"%sh\nhadoop fs -rm -r -f /tmp/ml-100k\n\nhadoop fs -mkdir /tmp/ml-100k\n\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/","user":"anonymous","dateUpdated":"2021-04-10T15:28:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068380316_-616483904","id":"20210410-152620_1253611568","dateCreated":"2021-04-10T15:26:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:899","dateFinished":"2021-04-10T15:29:21+0000","dateStarted":"2021-04-10T15:28:50+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"final case class Rating(movieID: Int, rating: Int)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\").map(x => {val fields = x.split(\"\\t\"); Rating(fields(1).toInt, fields(2).toInt)})","user":"anonymous","dateUpdated":"2021-04-10T15:33:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068529889_-699727584","id":"20210410-152849_2070855382","dateCreated":"2021-04-10T15:28:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1135","dateFinished":"2021-04-10T15:33:37+0000","dateStarted":"2021-04-10T15:33:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlines: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[5] at map at <console>:28\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068782608_1197806374","id":"20210410-153302_1170460694","dateCreated":"2021-04-10T15:33:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1200","text":"import sqlContext.implicits._\nval ratingsDF = lines.toDF()\n\nratingsDF.printSchema()","dateUpdated":"2021-04-10T15:34:38+0000","dateFinished":"2021-04-10T15:34:40+0000","dateStarted":"2021-04-10T15:34:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [movieID: int, rating: int]\nroot\n |-- movieID: integer (nullable = false)\n |-- rating: integer (nullable = false)\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068863754_-881838052","id":"20210410-153423_863482278","dateCreated":"2021-04-10T15:34:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1337","text":"val topMovieIDs = ratingsDF.groupBy(\"movieID\").count().orderBy(desc(\"count\")).cache()\ntopMovieIDs.show()","dateUpdated":"2021-04-10T15:35:56+0000","dateFinished":"2021-04-10T15:36:14+0000","dateStarted":"2021-04-10T15:35:57+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topMovieIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieID: int, count: bigint]\n+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  584|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n|    286|  481|\n|    288|  478|\n|      1|  452|\n|    300|  431|\n|    121|  429|\n|    174|  420|\n|    127|  413|\n|     56|  394|\n|      7|  392|\n|     98|  390|\n|    237|  384|\n|    117|  378|\n|    172|  368|\n|    222|  365|\n|    204|  350|\n+-------+-----+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618068956449_708633991","id":"20210410-153556_1517909304","dateCreated":"2021-04-10T15:35:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1450","text":"ratingsDF.registerTempTable(\"ratings\")","dateUpdated":"2021-04-10T15:37:31+0000","dateFinished":"2021-04-10T15:37:32+0000","dateStarted":"2021-04-10T15:37:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618069051026_-472405570","id":"20210410-153731_498030178","dateCreated":"2021-04-10T15:37:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1537","text":"%sql\n\nSELECT * FROM ratings LIMIT 10","dateUpdated":"2021-04-10T15:37:52+0000","dateFinished":"2021-04-10T15:37:56+0000","dateStarted":"2021-04-10T15:37:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieID\trating\n50\t5\n172\t5\n133\t1\n242\t3\n302\t3\n377\t1\n51\t2\n346\t1\n474\t4\n265\t2\n"}]}},{"text":"%sql\nSELECT rating, COUNT(*) as count FROM ratings GROUP BY rating\n","user":"anonymous","dateUpdated":"2021-04-10T15:39:43+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618069072045_-1559290564","id":"20210410-153752_1771662583","dateCreated":"2021-04-10T15:37:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1618","dateFinished":"2021-04-10T15:38:52+0000","dateStarted":"2021-04-10T15:38:49+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\tcount\n1\t6111\n3\t27145\n5\t21203\n4\t34174\n2\t11370\n"}]}},{"text":"final case class Movie(movieID: Int, title: String)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\").map(x => {val fields = x.split('|'); Movie(fields(0).toInt, fields(1))})\n\nimport sqlContext.implicits._\nval moviesDF = lines.toDF()\n\nmoviesDF.show()","user":"anonymous","dateUpdated":"2021-04-10T15:54:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618069128443_-160435509","id":"20210410-153848_434451183","dateCreated":"2021-04-10T15:38:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1758","dateFinished":"2021-04-10T15:54:04+0000","dateStarted":"2021-04-10T15:54:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[46] at map at <console>:39\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n+-------+--------------------+\n|movieID|               title|\n+-------+--------------------+\n|      1|    Toy Story (1995)|\n|      2|    GoldenEye (1995)|\n|      3|   Four Rooms (1995)|\n|      4|   Get Shorty (1995)|\n|      5|      Copycat (1995)|\n|      6|Shanghai Triad (Y...|\n|      7|Twelve Monkeys (1...|\n|      8|         Babe (1995)|\n|      9|Dead Man Walking ...|\n|     10|  Richard III (1995)|\n|     11|Seven (Se7en) (1995)|\n|     12|Usual Suspects, T...|\n|     13|Mighty Aphrodite ...|\n|     14|  Postino, Il (1994)|\n|     15|Mr. Holland's Opu...|\n|     16|French Twist (Gaz...|\n|     17|From Dusk Till Da...|\n|     18|White Balloon, Th...|\n|     19|Antonia's Line (1...|\n|     20|Angels and Insect...|\n+-------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618069329305_-547236204","id":"20210410-154209_1784876218","dateCreated":"2021-04-10T15:42:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2170","text":"moviesDF.registerTempTable(\"titles\")","dateUpdated":"2021-04-10T15:54:31+0000","dateFinished":"2021-04-10T15:54:32+0000","dateStarted":"2021-04-10T15:54:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618070071890_746730710","id":"20210410-155431_691651931","dateCreated":"2021-04-10T15:54:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2301","text":"%sql\n\nSELECT t.title, count(*) cnt FROM ratings r JOIN titles t ON r.movieID = t.movieID GROUP BY t.title ORDER BY cnt DESC LIMIT 20","dateUpdated":"2021-04-10T16:09:10+0000","dateFinished":"2021-04-10T15:59:23+0000","dateStarted":"2021-04-10T15:59:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tcnt\nStar Wars (1977)\t584\nContact (1997)\t509\nFargo (1996)\t508\nReturn of the Jedi (1983)\t507\nLiar Liar (1997)\t485\nEnglish Patient, The (1996)\t481\nScream (1996)\t478\nToy Story (1995)\t452\nAir Force One (1997)\t431\nIndependence Day (ID4) (1996)\t429\nRaiders of the Lost Ark (1981)\t420\nGodfather, The (1972)\t413\nPulp Fiction (1994)\t394\nTwelve Monkeys (1995)\t392\nSilence of the Lambs, The (1991)\t390\nJerry Maguire (1996)\t384\nChasing Amy (1997)\t379\nRock, The (1996)\t378\nEmpire Strikes Back, The (1980)\t368\nStar Trek: First Contact (1996)\t365\n"}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2021-04-10T15:59:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1618070353478_810985945","id":"20210410-155913_1799362631","dateCreated":"2021-04-10T15:59:13+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2382"}],"name":"Playing with movielens","id":"2G3XHR41Q","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}